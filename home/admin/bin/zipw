#!/bin/sh

FORMAT=gz

#Базовое имя, от которого строятся все остальные
N=$1

#Текущая дата
D=$(/bin/date +%Y%m%d)

#Команда могучего архиватора tar
#  -v       - подробно писать имена файлов
#  -c       - создать архив с указанным именем
#  --xz     - способ упаковки "xz" или "lzma"
#  -T<файл> - взять перечень файлов и каталогов из файла
#  -f<архив>- имя файла архива
#Выражение 2>&1 означает, что для запускаемой команды дескриптор файла 2 (stderr)
#  перенаправляется туда же, куда направлен дескриптор файла 1 (stdout).
#  Это полезно, потому что apache перехватывает только дескриптор 1 (stdout),
#  а все сообщения об ошибках традиционно направляются в дескриптор 2 (stderr)

if [ -r $N.lst ] ; then #Если доступен для чтения файл "$N.lst",
  tar -vc --$FORMAT -T $N.lst -f $N-$D.tar.$FORMAT 2>&1 # то запустить такую команду
else #а если lst-файла нет, то
  tar -vc --$FORMAT -f $N-$D.tar.$FORMAT $N 2>&1 #запустить такую
fi
